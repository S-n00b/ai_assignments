<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lenovo AI Architecture - Unified Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <!-- Octicons for animated icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/19.0.0/octicons.min.css">
    <style>
        /* Fallback for octicons if CDN fails */
        .octicon:before {
            font-family: 'Octicons';
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            text-rendering: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
    
    <style>
        :root {
            --lenovo-red: #E2231A;
            --lenovo-dark-red: #C01E17;
            --lenovo-black: #000000;
            --lenovo-gray: #666666;
            --lenovo-light-gray: #F5F5F5;
            --lenovo-white: #FFFFFF;
            --lenovo-blue: #0066CC;
            --lenovo-dark: #1A1A1A;
            --lenovo-card: #2A2A2A;
            --lenovo-border: #404040;
        }
        
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Inter', sans-serif;
            background-color: var(--lenovo-dark);
            color: var(--lenovo-white);
            overflow: hidden;
        }
        
        .lenovo-gradient {
            background: linear-gradient(135deg, var(--lenovo-red), var(--lenovo-dark-red));
        }
        
        .lenovo-text-gradient {
            background: linear-gradient(90deg, var(--lenovo-red), var(--lenovo-blue));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .lenovo-button {
            background: linear-gradient(135deg, var(--lenovo-red), var(--lenovo-dark-red));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .lenovo-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(226, 35, 26, 0.3);
        }
        
        .lenovo-button.active {
            background: linear-gradient(135deg, var(--lenovo-blue), #004499);
        }
        
        .lenovo-logo {
            background: linear-gradient(135deg, var(--lenovo-red), var(--lenovo-dark-red));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            font-size: 1.5rem;
        }
        
        .nav-link {
            color: #999;
            transition: color 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .nav-link:hover {
            color: var(--lenovo-red);
            background: rgba(226, 35, 26, 0.1);
        }
        
        .nav-link.active {
            color: var(--lenovo-red);
            background: rgba(226, 35, 26, 0.1);
            font-weight: 600;
        }
        
        .service-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }
        
        .service-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: var(--lenovo-card);
            color: var(--lenovo-white);
            font-size: 1.125rem;
        }
        
        .service-error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: var(--lenovo-card);
            color: var(--lenovo-red);
            text-align: center;
            padding: 2rem;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
        }
        
        .status-online {
            background: #22c55e;
            box-shadow: 0 0 6px rgba(34, 197, 94, 0.5);
        }
        
        .status-offline {
            background: #ef4444;
            box-shadow: 0 0 6px rgba(239, 68, 68, 0.5);
        }
        
        .status-unknown {
            background: #f59e0b;
            box-shadow: 0 0 6px rgba(245, 158, 11, 0.5);
        }
        
        .sidebar {
            width: 280px;
            background: var(--lenovo-card);
            border-right: 1px solid var(--lenovo-border);
            height: 100vh;
            overflow-y: auto;
            transition: width 0.3s ease;
        }
        
        .sidebar.collapsed {
            width: 48px;
            padding: 0;
        }
        
        @media (max-width: 768px) {
            .sidebar.collapsed {
                width: 40px;
            }
            
            .sidebar-toggle {
                left: 24px; /* Adjust for medium screens */
            }
            
            .sidebar.collapsed .sidebar-toggle {
                left: 13px; /* Center in 40px collapsed sidebar */
            }
        }
        
        @media (max-width: 480px) {
            .sidebar.collapsed {
                width: 36px;
            }
            
            .sidebar-toggle {
                left: 22px; /* Adjust for small screens */
            }
            
            .sidebar.collapsed .sidebar-toggle {
                left: 11px; /* Center in 36px collapsed sidebar */
            }
            
            .sidebar.collapsed .nav-link {
                padding: 2px;
                min-height: 28px;
            }
            
            .sidebar.collapsed .nav-icon {
                width: 18px;
                height: 18px;
            }
            
            .sidebar.collapsed .nav-icon .octicon {
                font-size: 14px;
            }
            
            .sidebar.collapsed .status-badge {
                width: 6px;
                height: 6px;
            }
        }
        
        .sidebar-toggle {
            position: absolute;
            top: 24px; /* Align with vertical center of logo section */
            left: 28px; /* Align with horizontal center of nav icons */
            width: 16px;
            height: 16px;
            background: var(--lenovo-card);
            border: 1px solid var(--lenovo-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        
        .sidebar.collapsed .sidebar-toggle {
            top: 24px; /* Keep same vertical position */
            left: 16px; /* Center horizontally in collapsed sidebar */
            width: 14px;
            height: 14px;
        }
        
        .sidebar-toggle:hover {
            background: var(--lenovo-red);
            border-color: var(--lenovo-red);
        }
        
        .sidebar-toggle.collapsed {
            transform: rotate(180deg);
        }
        
        .hamburger {
            width: 10px;
            height: 2px;
            background: var(--lenovo-white);
            position: relative;
            transition: all 0.3s ease;
        }
        
        .hamburger::before,
        .hamburger::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 2px;
            background: var(--lenovo-white);
            transition: all 0.3s ease;
        }
        
        .sidebar.collapsed .hamburger {
            width: 8px;
            height: 1px;
        }
        
        .sidebar.collapsed .hamburger::before,
        .sidebar.collapsed .hamburger::after {
            width: 8px;
            height: 1px;
        }
        
        .hamburger::before {
            top: -4px;
        }
        
        .hamburger::after {
            top: 4px;
        }
        
        .sidebar-content {
            transition: opacity 0.3s ease;
            padding: 0;
        }
        
        .sidebar.collapsed .sidebar-content {
            opacity: 1;
            pointer-events: auto;
        }
        
        .sidebar.collapsed .sidebar-content .p-6 {
            padding: 0;
            margin: 0;
        }
        
        /* Navigation section alignment */
        .sidebar-content .p-4 {
            padding-left: 1rem; /* Standard left padding */
            padding-right: 1rem;
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        
        .sidebar.collapsed .sidebar-content .p-4 {
            padding: 0;
            margin: 0;
        }
        
        .sidebar.collapsed .lenovo-logo,
        .sidebar.collapsed .text-sm {
            opacity: 0;
            visibility: hidden;
            height: 0;
            overflow: hidden;
        }
        
        /* Logo section alignment */
        .sidebar-content .p-6 {
            padding-left: 52px; /* Align with nav icon horizontal position */
            padding-right: 1.5rem;
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
        }
        
        .lenovo-logo {
            margin-left: 0; /* Remove any default margin */
        }
        
        .text-sm {
            margin-left: 0; /* Remove any default margin */
        }
        
        .sidebar.collapsed .border-b {
            border-bottom: none;
            padding: 0;
            margin: 0;
            height: 60px; /* Preserve header section height */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .sidebar.collapsed .space-y-2 > * {
            margin-bottom: 8px; /* Preserve vertical spacing between nav items */
        }
        
        .sidebar.collapsed .space-y-1 > * {
            margin-bottom: 4px; /* Preserve vertical spacing for external links */
        }
        
        .sidebar.collapsed .space-y-2 > *:last-child {
            margin-bottom: 0;
        }
        
        .sidebar.collapsed .space-y-1 > *:last-child {
            margin-bottom: 0;
        }
        
        .sidebar.collapsed .mt-8 {
            margin-top: 32px; /* Preserve top margin for external links section */
        }
        
        .sidebar.collapsed .pt-4 {
            padding-top: 16px; /* Preserve padding for section divider */
        }
        
        .sidebar.collapsed .text-xs {
            opacity: 0;
            visibility: hidden;
            height: 0;
            overflow: hidden;
        }
        
        .nav-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .nav-icon .octicon {
            font-size: 18px;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            color: #999;
            display: inline-block;
        }
        
        .nav-link:hover .nav-icon .octicon {
            color: var(--lenovo-red);
            transform: scale(1.1);
        }
        
        .nav-link.active .nav-icon .octicon {
            color: var(--lenovo-red);
        }
        
        .status-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            border: 1px solid var(--lenovo-card);
            z-index: 2;
        }
        
        .status-badge.online {
            background: #22c55e;
            box-shadow: 0 0 6px rgba(34, 197, 94, 0.5);
        }
        
        .status-badge.offline {
            background: #ef4444;
            box-shadow: 0 0 6px rgba(239, 68, 68, 0.5);
        }
        
        .status-badge.unknown {
            background: #f59e0b;
            box-shadow: 0 0 6px rgba(245, 158, 11, 0.5);
        }
        
        .nav-link-text {
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .nav-link-text {
            opacity: 0;
            pointer-events: none;
            display: none;
        }
        
        .sidebar.collapsed .nav-link {
            justify-content: center;
            padding: 4px;
            margin: 0; /* Remove margin, spacing handled by parent */
            min-height: 32px;
            display: flex;
            align-items: center;
        }
        
        .sidebar.collapsed .nav-icon {
            margin-right: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .sidebar.collapsed .nav-icon .octicon {
            opacity: 1;
            z-index: 10;
            position: relative;
            font-size: 16px;
            color: #999;
        }
        
        .sidebar.collapsed .nav-link:hover .nav-icon .octicon {
            color: var(--lenovo-red);
            transform: scale(1.1);
        }
        
        .sidebar.collapsed .nav-link.active .nav-icon .octicon {
            color: var(--lenovo-red);
        }
        
        .sidebar.collapsed .status-badge {
            opacity: 1;
            z-index: 11;
            width: 8px;
            height: 8px;
            top: 0px;
            right: 0px;
        }
        
        .sidebar.collapsed .nav-icon {
            z-index: 10;
            position: relative;
        }
        
        /* Ensure external links icons are visible when collapsed */
        .sidebar.collapsed .nav-link .nav-icon .octicon {
            opacity: 1 !important;
            visibility: visible !important;
            display: inline-block !important;
            font-size: 16px;
            color: #999;
        }
        
        .sidebar.collapsed .nav-link:hover .nav-icon .octicon {
            color: var(--lenovo-red) !important;
            transform: scale(1.1);
        }
        
        /* Ensure external links section remains visible when collapsed */
        .sidebar.collapsed .mt-8 {
            margin-top: 32px;
        }
        
        .sidebar.collapsed .pt-4 {
            padding-top: 16px;
        }
        
        .sidebar.collapsed .border-t {
            border-top: 1px solid var(--lenovo-border);
        }
        
        .sidebar.collapsed .space-y-1 > * {
            margin-bottom: 4px;
        }
        
        .sidebar.collapsed .space-y-1 > *:last-child {
            margin-bottom: 0;
        }
        
        .main-content {
            flex: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .top-bar {
            height: 60px;
            background: var(--lenovo-card);
            border-bottom: 1px solid var(--lenovo-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
        }
        
        .content-area {
            flex: 1;
            position: relative;
        }
        
        .service-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
        }
        
        .service-container.active {
            display: block;
        }
        
        .service-info {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(26, 26, 26, 0.9);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--lenovo-border);
            font-size: 0.875rem;
            z-index: 1000;
        }
        
        .refresh-button {
            background: var(--lenovo-blue);
            color: white;
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }
        
        .refresh-button:hover {
            background: #004499;
        }
    </style>
</head>
<body>
    <div class="flex h-screen">
        <!-- Sidebar Navigation -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-toggle" id="sidebar-toggle">
                <div class="hamburger"></div>
            </div>
            
            <div class="sidebar-content">
                <div class="p-6 border-b border-lenovo-border">
                    <div class="lenovo-logo">Lenovo AI</div>
                    <div class="text-sm text-gray-400 mt-1">Unified Platform</div>
                </div>
                
                <nav class="p-4">
                    <div class="space-y-2">
                        <a href="#" class="nav-link active" data-service="about">
                            <div class="nav-icon">
                                <span class="octicon octicon-heart-fill">♥</span>
                                <span class="status-badge online"></span>
                            </div>
                            <span class="nav-link-text">Assignment</span>
                        </a>
                        <a href="#" class="nav-link" data-service="chat-playground">
                            <div class="nav-icon">
                                <span class="octicon octicon-comment-discussion">💬</span>
                                <span class="status-badge online"></span>
                            </div>
                            <span class="nav-link-text">Chat Playground</span>
                        </a>
                        <a href="#" class="nav-link" data-service="gradio">
                            <div class="nav-icon">
                                <span class="octicon octicon-cpu">⚙</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">Model Evaluation</span>
                        </a>
                        <a href="#" class="nav-link" data-service="mlflow">
                            <div class="nav-icon">
                                <span class="octicon octicon-graph">📊</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">MLflow Tracking</span>
                        </a>
                        <a href="#" class="nav-link" data-service="chroma">
                            <div class="nav-icon">
                                <span class="octicon octicon-database">🗄</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">ChromaDB Vector Store</span>
                        </a>
                        <a href="#" class="nav-link" data-service="langgraph">
                            <div class="nav-icon">
                                <span class="octicon octicon-workflow">🔄</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">LangGraph Studio</span>
                        </a>
                        <a href="#" class="nav-link" data-service="neo4j-faker">
                            <div class="nav-icon">
                                <span class="octicon octicon-graph">🕸️</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">Neo4j GraphRAG Demo</span>
                        </a>
                        <a href="#" class="nav-link" data-service="mkdocs">
                            <div class="nav-icon">
                                <span class="octicon octicon-book">📖</span>
                                <span class="status-badge unknown"></span>
                            </div>
                            <span class="nav-link-text">Documentation Hub</span>
                        </a>
                    </div>
                    
                    <div class="mt-8 pt-4 border-t border-lenovo-border">
                        <div class="text-xs text-gray-500 mb-2 nav-link-text">External Links</div>
                        <div class="space-y-1">
                            <a href="https://s-n00b.github.io/ai_assignments" target="_blank" class="nav-link">
                                <div class="nav-icon">
                                    <span class="octicon octicon-globe">🌐</span>
                                </div>
                                <span class="nav-link-text">GitHub Pages</span>
                            </a>
                            <a href="https://github.com/S-n00b/ai_assignments" target="_blank" class="nav-link">
                                <div class="nav-icon">
                                    <span class="octicon octicon-mark-github">🐙</span>
                                </div>
                                <span class="nav-link-text">GitHub Repository</span>
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        
        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div>
                    <h1 id="service-title" class="text-xl font-semibold">Assignment</h1>
                    <div id="service-description" class="text-sm text-gray-400">Lenovo AI Architecture Meta-Assignment Portfolio</div>
                </div>
                <div class="flex items-center space-x-4">
                    <div id="service-status" class="text-sm text-gray-400">
                        <span class="status-indicator status-online"></span>
                        Ready
                    </div>
                    <button id="refresh-service" class="refresh-button" onclick="refreshCurrentService()">
                        Refresh
                    </button>
                </div>
            </div>
            
            <!-- Content Area -->
            <div class="content-area">
                <!-- Assignment Service -->
                <div id="service-about" class="service-container active">
                    <div id="about-content" class="h-full flex flex-col bg-gray-900">
                        
                        <!-- Assignment Content -->
                        <div class="flex-1 overflow-y-auto p-8">
                            <div class="max-w-4xl mx-auto text-center">
                                
                                <div class="text-center">
                                    <div class="text-lg text-gray-300 mb-4">Ready to explore the Lenovo AI Architecture framework?</div>
                                    <div class="text-sm text-gray-500">
                                        This is a static preview. For the full interactive experience, 
                                        <br>run the services locally using the provided scripts.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Chat Playground Service -->
                <div id="service-chat-playground" class="service-container">
                    <div id="chat-playground-content" class="h-full flex flex-col bg-gray-900">
                        <!-- Chat Playground Header -->
                        <div class="bg-gray-800 border-b border-gray-700 p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-white">AI Model Chat Playground</h2>
                                    <p class="text-sm text-gray-400">Compare Ollama and GitHub Models side-by-side</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <button id="clear-chat" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
                                        Clear Chat
                                    </button>
                                    <button id="export-chat" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        Export Chat
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Model Selection -->
                        <div class="bg-gray-800 border-b border-gray-700 p-4">
                            <div class="grid grid-cols-2 gap-6">
                                <!-- Ollama Model Selection -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">Ollama Model</label>
                                    <div class="flex space-x-2">
                                        <select id="ollama-model" class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500">
                                            <option value="">Loading models...</option>
                                        </select>
                                        <button id="refresh-ollama-models" class="px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors">
                                            🔄
                                        </button>
                                    </div>
                                    <div id="ollama-status" class="text-xs text-gray-400 mt-1">Status: Checking...</div>
                                </div>
                                
                                <!-- GitHub Model Selection -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-2">GitHub Model</label>
                                    <div class="flex space-x-2">
                                        <select id="github-model" class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="openai/gpt-4o">GPT-4o</option>
                                            <option value="openai/gpt-4o-mini">GPT-4o Mini</option>
                                            <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                            <option value="meta/llama-3.1-8b">Llama 3.1 8B</option>
                                            <option value="meta/llama-3.1-70b">Llama 3.1 70B</option>
                                        </select>
                                        <button id="refresh-github-models" class="px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors">
                                            🔄
                                        </button>
                                    </div>
                                    <div id="github-status" class="text-xs text-gray-400 mt-1">Status: Available</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chat Interface -->
                        <div class="flex-1 flex overflow-hidden">
                            <!-- Ollama Chat -->
                            <div class="flex-1 flex flex-col border-r border-gray-700">
                                <div class="bg-red-900/20 border-b border-red-800/30 p-3">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                                        <span class="text-sm font-medium text-red-300">Ollama (Local)</span>
                                        <span id="ollama-model-name" class="text-xs text-gray-400">No model selected</span>
                                    </div>
                                </div>
                                <div id="ollama-chat" class="flex-1 overflow-y-auto p-4 space-y-4">
                                    <div class="text-center text-gray-500 py-8">
                                        <div class="text-4xl mb-2">🤖</div>
                                        <p>Select an Ollama model to start chatting</p>
                                    </div>
                                </div>
                                <div class="border-t border-gray-700 p-4">
                                    <div class="flex space-x-2">
                                        <input id="ollama-input" type="text" placeholder="Type your message..." 
                                               class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500" 
                                               disabled>
                                        <button id="ollama-send" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50" disabled>
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- GitHub Models Chat -->
                            <div class="flex-1 flex flex-col">
                                <div class="bg-blue-900/20 border-b border-blue-800/30 p-3">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                        <span class="text-sm font-medium text-blue-300">GitHub Models (Cloud)</span>
                                        <span id="github-model-name" class="text-xs text-gray-400">GPT-4o</span>
                                    </div>
                                </div>
                                <div id="github-chat" class="flex-1 overflow-y-auto p-4 space-y-4">
                                    <div class="text-center text-gray-500 py-8">
                                        <div class="text-4xl mb-2">☁️</div>
                                        <p>Ready to chat with GitHub Models</p>
                                    </div>
                                </div>
                                <div class="border-t border-gray-700 p-4">
                                    <div class="flex space-x-2">
                                        <input id="github-input" type="text" placeholder="Type your message..." 
                                               class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <button id="github-send" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Performance Metrics -->
                        <div class="bg-gray-800 border-t border-gray-700 p-4">
                            <div class="grid grid-cols-4 gap-4 text-sm">
                                <div class="text-center">
                                    <div class="text-gray-400">Ollama Response Time</div>
                                    <div id="ollama-latency" class="text-white font-mono">-- ms</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-gray-400">GitHub Response Time</div>
                                    <div id="github-latency" class="text-white font-mono">-- ms</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-gray-400">Ollama Tokens</div>
                                    <div id="ollama-tokens" class="text-white font-mono">0</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-gray-400">GitHub Tokens</div>
                                    <div id="github-tokens" class="text-white font-mono">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Gradio Model Evaluation Service -->
                <div id="service-gradio" class="service-container">
                    <iframe id="iframe-gradio" class="service-frame" src="http://localhost:7860"></iframe>
                </div>
                
                <!-- MLflow Tracking Service -->
                <div id="service-mlflow" class="service-container">
                    <iframe id="iframe-mlflow" class="service-frame" src="http://localhost:5000"></iframe>
                </div>
                
                <!-- ChromaDB Vector Store Service -->
                <div id="service-chroma" class="service-container">
                    <div id="chroma-content" class="h-full flex flex-col bg-gray-900">
                        <!-- Header -->
                        <div class="bg-gray-800 border-b border-gray-700 p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-white">🗄️ ChromaDB Vector Store</h2>
                                    <p class="text-sm text-gray-400">Tools & RAG - Knowledge Retrieval System for GenAI Stack</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button id="test-chroma" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors">
                                        Test v2 API
                                    </button>
                                    <button id="refresh-chroma" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors">
                                        Refresh Status
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- GenAI Stack Context -->
                        <div class="bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-b border-blue-800/30 p-4">
                            <div class="text-center">
                                <h3 class="text-lg font-semibold text-blue-300 mb-2">🔗 GenAI Stack Integration</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                    <div class="bg-gray-800/50 p-2 rounded text-center">
                                        <div class="text-yellow-400">📊</div>
                                        <div class="text-gray-300">Evaluation</div>
                                    </div>
                                    <div class="bg-gray-800/50 p-2 rounded text-center">
                                        <div class="text-red-400">🛡️</div>
                                        <div class="text-gray-300">Guardrails</div>
                                    </div>
                                    <div class="bg-gray-800/50 p-2 rounded text-center border-2 border-blue-500">
                                        <div class="text-blue-400">🔧</div>
                                        <div class="text-blue-300 font-semibold">Tools & RAG</div>
                                    </div>
                                    <div class="bg-gray-800/50 p-2 rounded text-center">
                                        <div class="text-green-400">🧠</div>
                                        <div class="text-gray-300">Core LLM</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Main Content -->
                        <div class="flex-1 overflow-y-auto p-4">
                            <div id="chroma-status" class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">🗄️</div>
                                <p>ChromaDB Vector Store</p>
                                <p class="text-sm mt-2">Click "Test v2 API" to check connection and view collections</p>
                            </div>
                            
                            <!-- Vector Operations Demo -->
                            <div id="chroma-demo" class="hidden">
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <!-- Collections Panel -->
                                    <div class="bg-gray-800 p-4 rounded-lg">
                                        <h3 class="text-lg font-semibold text-white mb-3">📚 Collections</h3>
                                        <div id="collections-list" class="space-y-2">
                                            <!-- Collections will be loaded here -->
                                        </div>
                                        <button id="create-collection" class="mt-3 w-full px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors">
                                            + Create New Collection
                                        </button>
                                    </div>
                                    
                                    <!-- Vector Operations Panel -->
                                    <div class="bg-gray-800 p-4 rounded-lg">
                                        <h3 class="text-lg font-semibold text-white mb-3">🔍 Vector Operations</h3>
                                        <div class="space-y-3">
                                            <div>
                                                <label class="block text-sm text-gray-300 mb-1">Add Document</label>
                                                <textarea id="document-text" placeholder="Enter document text..." class="w-full p-2 bg-gray-700 border border-gray-600 rounded text-white text-sm" rows="3"></textarea>
                                                <button id="add-document" class="mt-2 px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors">
                                                    Add to Collection
                                                </button>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm text-gray-300 mb-1">Search Similar</label>
                                                <input id="search-query" type="text" placeholder="Enter search query..." class="w-full p-2 bg-gray-700 border border-gray-600 rounded text-white text-sm">
                                                <button id="search-similar" class="mt-2 px-3 py-1 bg-purple-600 text-white rounded text-sm hover:bg-purple-700 transition-colors">
                                                    Find Similar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Results Panel -->
                                <div class="mt-6 bg-gray-800 p-4 rounded-lg">
                                    <h3 class="text-lg font-semibold text-white mb-3">📊 Results</h3>
                                    <div id="chroma-results" class="text-gray-300">
                                        <!-- Results will be displayed here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- LangGraph Studio Service -->
                <div id="service-langgraph" class="service-container">
                    <div id="langgraph-content" class="h-full flex flex-col bg-gray-900">
                        <div class="bg-gray-800 border-b border-gray-700 p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-white">LangGraph Studio</h2>
                                    <p class="text-sm text-gray-400">Agent visualization and debugging interface</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <button id="start-langgraph" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                        Start Studio
                                    </button>
                                    <button id="open-langgraph" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        Open Studio
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto p-4">
                            <div id="langgraph-status" class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">🔄</div>
                                <p>LangGraph Studio</p>
                                <p class="text-sm mt-2">Click "Start Studio" to launch the agent visualization interface</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Neo4j GraphRAG Demo Service -->
                <div id="service-neo4j-faker" class="service-container">
                    <div id="neo4j-content" class="h-full flex flex-col bg-gray-900">
                        <div class="bg-gray-800 border-b border-gray-700 p-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h2 class="text-xl font-semibold text-white">Neo4j GraphRAG Demo</h2>
                                    <p class="text-sm text-gray-400">Realistic GraphRAG demonstration with Faker data</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <button id="generate-data" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                        Generate Data
                                    </button>
                                    <button id="open-dashboard" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                        Open Dashboard
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto p-4">
                            <div id="neo4j-status" class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">🕸️</div>
                                <p>Neo4j GraphRAG Demo</p>
                                <p class="text-sm mt-2">Click "Generate Data" to create realistic graph data for demonstration</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- MkDocs Documentation Hub Service -->
                <div id="service-mkdocs" class="service-container">
                    <iframe id="iframe-mkdocs" class="service-frame" src="http://localhost:8082"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Service configuration
        const services = {
            about: {
                title: "Assignment",
                description: "Lenovo AI Architecture Meta-Assignment Portfolio",
                url: "#",
                status: "online"
            },
            "chat-playground": {
                title: "Chat Playground",
                description: "Compare Ollama and GitHub Models side-by-side",
                url: "/chat-playground",
                status: "online"
            },
            gradio: {
                title: "Model Evaluation",
                description: "Gradio Model Testing Interface",
                url: "http://localhost:7860",
                status: "unknown"
            },
            mlflow: {
                title: "MLflow Tracking",
                description: "MLflow Experiment Tracking UI",
                url: "http://localhost:5000",
                status: "unknown"
            },
            chroma: {
                title: "ChromaDB Vector Store",
                description: "ChromaDB Vector Database Interface",
                url: "http://localhost:8081",
                status: "unknown"
            },
            langgraph: {
                title: "LangGraph Studio",
                description: "Agent Visualization & Debugging",
                url: "http://localhost:8083",
                status: "unknown"
            },
            "neo4j-faker": {
                title: "Neo4j GraphRAG Demo",
                description: "Realistic GraphRAG Demo with Faker Data",
                url: "/iframe/neo4j-faker",
                status: "unknown"
            },
            mkdocs: {
                title: "Documentation Hub",
                description: "MkDocs Global Documentation Site",
                url: "http://localhost:8082",
                status: "unknown"
            }
        };
        
        let currentService = 'about';
        
        // Initialize the platform
        document.addEventListener('DOMContentLoaded', function() {
            // Set up navigation
            setupNavigation();
            
            // Set up sidebar toggle
            setupSidebarToggle();
            
            // Check service statuses
            checkServiceStatuses();
            
            // Set up periodic status checks
            setInterval(checkServiceStatuses, 30000); // Check every 30 seconds
        });
        
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link[data-service]');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const serviceName = this.dataset.service;
                    switchService(serviceName);
                });
            });
        }
        
        function setupSidebarToggle() {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.getElementById('sidebar-toggle');
            
            toggle.addEventListener('click', function() {
                sidebar.classList.toggle('collapsed');
                toggle.classList.toggle('collapsed');
            });
        }
        
        function switchService(serviceName) {
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelector(`[data-service="${serviceName}"]`).classList.add('active');
            
            // Update content
            document.querySelectorAll('.service-container').forEach(container => {
                container.classList.remove('active');
            });
            document.getElementById(`service-${serviceName}`).classList.add('active');
            
            // Update top bar
            const service = services[serviceName];
            document.getElementById('service-title').textContent = service.title;
            document.getElementById('service-description').textContent = service.description;
            
            // Update status
            updateServiceStatus(serviceName, service.status);
            
            currentService = serviceName;
        }
        
        function updateServiceStatus(serviceName, status) {
            const statusElement = document.getElementById('service-status');
            const statusIndicator = statusElement.querySelector('.status-indicator');
            
            statusIndicator.className = `status-indicator status-${status}`;
            
            const statusText = {
                'online': 'Online',
                'offline': 'Offline',
                'unknown': 'Checking...'
            };
            
            statusElement.innerHTML = `<span class="status-indicator status-${status}"></span>${statusText[status]}`;
            
            // Update nav link status badge
            const navLink = document.querySelector(`[data-service="${serviceName}"]`);
            if (navLink) {
                const statusBadge = navLink.querySelector('.status-badge');
                if (statusBadge) {
                    statusBadge.className = `status-badge ${status}`;
                }
            }
        }
        
        async function checkServiceStatuses() {
            for (const [serviceName, service] of Object.entries(services)) {
                if (serviceName === 'about') {
                    // This is served by the same FastAPI app
                    updateServiceStatus(serviceName, 'online');
                    continue;
                }
                
                if (serviceName === 'chat-playground') {
                    // This is served by the same FastAPI app
                    updateServiceStatus(serviceName, 'online');
                    continue;
                }
                
                try {
                    // For external services, use a more robust check
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout
                    
                    const response = await fetch(service.url, {
                        method: 'HEAD',
                        mode: 'no-cors',
                        cache: 'no-cache',
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    updateServiceStatus(serviceName, 'online');
                } catch (error) {
                    // For services that might not be running, show as unknown instead of offline
                    if (serviceName === 'gradio' || serviceName === 'mlflow' || serviceName === 'chroma' || 
                        serviceName === 'langgraph' || serviceName === 'neo4j-faker' || serviceName === 'mkdocs') {
                        updateServiceStatus(serviceName, 'unknown');
                    } else {
                        updateServiceStatus(serviceName, 'offline');
                    }
                }
            }
        }
        
        function refreshCurrentService() {
            if (currentService === 'about') {
                // For the about service, we don't need to refresh as it's embedded content
                return;
            }
            const iframe = document.querySelector(`#service-${currentService} iframe`);
            if (iframe) {
                iframe.src = iframe.src;
            }
        }
        
        // Handle iframe load events
        document.querySelectorAll('iframe').forEach(iframe => {
            iframe.addEventListener('load', function() {
                console.log(`Loaded: ${this.src}`);
            });
            
            iframe.addEventListener('error', function() {
                console.error(`Failed to load: ${this.src}`);
            });
        });
        
        // Chat Playground functionality
        class ChatPlayground {
            constructor() {
                this.ollamaModels = [];
                this.githubModels = [
                    { id: "openai/gpt-4o", name: "GPT-4o" },
                    { id: "openai/gpt-4o-mini", name: "GPT-4o Mini" },
                    { id: "openai/gpt-3.5-turbo", name: "GPT-3.5 Turbo" },
                    { id: "meta/llama-3.1-8b", name: "Llama 3.1 8B" },
                    { id: "meta/llama-3.1-70b", name: "Llama 3.1 70B" }
                ];
                this.selectedOllamaModel = null;
                this.selectedGitHubModel = "openai/gpt-4o";
                this.chatHistory = {
                    ollama: [],
                    github: []
                };
                this.metrics = {
                    ollama: { latency: 0, tokens: 0 },
                    github: { latency: 0, tokens: 0 }
                };
                
                this.initializeEventListeners();
                this.loadOllamaModels();
                this.loadGitHubModels();
                this.updateGitHubModelDisplay();
            }
            
            initializeEventListeners() {
                // Model selection
                document.getElementById('ollama-model').addEventListener('change', (e) => {
                    this.selectedOllamaModel = e.target.value;
                    this.updateOllamaModelDisplay();
                    this.updateOllamaInputState();
                });
                
                document.getElementById('github-model').addEventListener('change', (e) => {
                    this.selectedGitHubModel = e.target.value;
                    this.updateGitHubModelDisplay();
                });
                
                // Refresh buttons
                document.getElementById('refresh-ollama-models').addEventListener('click', () => {
                    this.loadOllamaModels();
                });
                
                document.getElementById('refresh-github-models').addEventListener('click', () => {
                    this.loadGitHubModels();
                });
                
                // Send buttons
                document.getElementById('ollama-send').addEventListener('click', () => {
                    this.sendOllamaMessage();
                });
                
                document.getElementById('github-send').addEventListener('click', () => {
                    this.sendGitHubMessage();
                });
                
                // Input enter key
                document.getElementById('ollama-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendOllamaMessage();
                    }
                });
                
                document.getElementById('github-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendGitHubMessage();
                    }
                });
                
                // Clear and export buttons
                document.getElementById('clear-chat').addEventListener('click', () => {
                    this.clearChat();
                });
                
                document.getElementById('export-chat').addEventListener('click', () => {
                    this.exportChat();
                });
            }
            
            async loadOllamaModels() {
                try {
                    document.getElementById('ollama-status').textContent = 'Status: Loading...';
                    
                    const response = await fetch('/api/ollama/models');
                    if (response.ok) {
                        const data = await response.json();
                        this.ollamaModels = data.models || [];
                        this.populateOllamaSelect();
                        document.getElementById('ollama-status').textContent = `Status: ${this.ollamaModels.length} models available`;
                    } else {
                        throw new Error('Failed to load Ollama models');
                    }
                } catch (error) {
                    console.error('Error loading Ollama models:', error);
                    document.getElementById('ollama-status').textContent = 'Status: Error loading models';
                    this.ollamaModels = [];
                    this.populateOllamaSelect();
                }
            }
            
            populateOllamaSelect() {
                const select = document.getElementById('ollama-model');
                select.innerHTML = '<option value="">Select a model...</option>';
                
                this.ollamaModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.name || model;
                    option.textContent = model.name || model;
                    select.appendChild(option);
                });
            }
            
            async loadGitHubModels() {
                try {
                    document.getElementById('github-status').textContent = 'Status: Loading...';
                    
                    const response = await fetch('/api/github-models/available');
                    if (response.ok) {
                        const data = await response.json();
                        this.githubModels = data.models || this.githubModels; // Fallback to default if API fails
                        this.populateGitHubSelect();
                        document.getElementById('github-status').textContent = `Status: ${this.githubModels.length} models available`;
                    } else {
                        throw new Error('Failed to load GitHub models');
                    }
                } catch (error) {
                    console.error('Error loading GitHub models:', error);
                    document.getElementById('github-status').textContent = 'Status: Using default models';
                    // Keep default models if API fails
                    this.populateGitHubSelect();
                }
            }
            
            populateGitHubSelect() {
                const select = document.getElementById('github-model');
                select.innerHTML = '';
                
                this.githubModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.id || model;
                    option.textContent = model.name || model;
                    select.appendChild(option);
                });
            }
            
            updateOllamaModelDisplay() {
                const modelName = this.selectedOllamaModel || 'No model selected';
                document.getElementById('ollama-model-name').textContent = modelName;
            }
            
            updateGitHubModelDisplay() {
                const model = this.githubModels.find(m => m.id === this.selectedGitHubModel);
                const modelName = model ? model.name : this.selectedGitHubModel;
                document.getElementById('github-model-name').textContent = modelName;
            }
            
            updateOllamaInputState() {
                const input = document.getElementById('ollama-input');
                const sendButton = document.getElementById('ollama-send');
                const enabled = this.selectedOllamaModel !== null && this.selectedOllamaModel !== '';
                
                input.disabled = !enabled;
                sendButton.disabled = !enabled;
            }
            
            async sendOllamaMessage() {
                const input = document.getElementById('ollama-input');
                const message = input.value.trim();
                
                if (!message || !this.selectedOllamaModel) return;
                
                // Add user message to chat
                this.addMessageToChat('ollama', 'user', message);
                input.value = '';
                
                // Show typing indicator
                const typingId = this.addTypingIndicator('ollama');
                
                try {
                    const startTime = Date.now();
                    
                    const response = await fetch('/api/ollama/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model_name: this.selectedOllamaModel,
                            prompt: message,
                            parameters: {
                                temperature: 0.7,
                                max_tokens: 1000
                            }
                        })
                    });
                    
                    const endTime = Date.now();
                    const latency = endTime - startTime;
                    
                    if (response.ok) {
                        const data = await response.json();
                        const responseText = data.response || data.message || 'No response received';
                        
                        // Remove typing indicator and add response
                        this.removeTypingIndicator('ollama', typingId);
                        this.addMessageToChat('ollama', 'assistant', responseText);
                        
                        // Update metrics
                        this.metrics.ollama.latency = latency;
                        this.metrics.ollama.tokens += this.estimateTokens(responseText);
                        this.updateMetrics();
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('Error sending Ollama message:', error);
                    this.removeTypingIndicator('ollama', typingId);
                    this.addMessageToChat('ollama', 'error', `Error: ${error.message}`);
                }
            }
            
            async sendGitHubMessage() {
                const input = document.getElementById('github-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                // Add user message to chat
                this.addMessageToChat('github', 'user', message);
                input.value = '';
                
                // Show typing indicator
                const typingId = this.addTypingIndicator('github');
                
                try {
                    const startTime = Date.now();
                    
                    const response = await fetch('/api/github-models/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model_id: this.selectedGitHubModel,
                            prompt: message,
                            parameters: {
                                temperature: 0.7,
                                max_tokens: 1000
                            }
                        })
                    });
                    
                    const endTime = Date.now();
                    const latency = endTime - startTime;
                    
                    if (response.ok) {
                        const data = await response.json();
                        const responseText = data.response || 'No response received';
                        
                        // Remove typing indicator and add response
                        this.removeTypingIndicator('github', typingId);
                        this.addMessageToChat('github', 'assistant', responseText);
                        
                        // Update metrics
                        this.metrics.github.latency = latency;
                        this.metrics.github.tokens += this.estimateTokens(responseText);
                        this.updateMetrics();
                    } else {
                        // Fallback to simulation if API is not available
                        console.warn('GitHub Models API not available, using simulation');
                        const simulatedResponse = await this.simulateGitHubResponse(message);
                        
                        this.removeTypingIndicator('github', typingId);
                        this.addMessageToChat('github', 'assistant', simulatedResponse);
                        
                        this.metrics.github.latency = latency;
                        this.metrics.github.tokens += this.estimateTokens(simulatedResponse);
                        this.updateMetrics();
                    }
                    
                } catch (error) {
                    console.error('Error sending GitHub message:', error);
                    this.removeTypingIndicator('github', typingId);
                    this.addMessageToChat('github', 'error', `Error: ${error.message}`);
                }
            }
            
            async simulateGitHubResponse(message) {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                
                // Simulate different responses based on model
                const responses = {
                    "openai/gpt-4o": `I'm GPT-4o, a multimodal AI model. You asked: "${message}". I can process both text and images, and I'm designed to be helpful, harmless, and honest. How can I assist you further?`,
                    "openai/gpt-4o-mini": `Hi! I'm GPT-4o Mini, a faster and more cost-effective version of GPT-4o. Regarding your question "${message}", I'd be happy to help. What would you like to know more about?`,
                    "openai/gpt-3.5-turbo": `Hello! I'm GPT-3.5 Turbo. You mentioned: "${message}". I'm here to help with your questions and provide useful information. What else can I help you with?`,
                    "meta/llama-3.1-8b": `Greetings! I'm Llama 3.1 8B, an open-source language model. You asked about "${message}". I'm designed to be helpful and informative. How can I assist you today?`,
                    "meta/llama-3.1-70b": `Hello! I'm Llama 3.1 70B, a larger open-source model with enhanced capabilities. Regarding "${message}", I'm here to provide detailed and accurate responses. What would you like to explore?`
                };
                
                return responses[this.selectedGitHubModel] || `I'm a GitHub Model responding to: "${message}". How can I help you today?`;
            }
            
            addMessageToChat(service, role, content) {
                const chatContainer = document.getElementById(`${service}-chat`);
                const messageId = `msg-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                
                const messageDiv = document.createElement('div');
                messageDiv.id = messageId;
                messageDiv.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'}`;
                
                const messageContent = document.createElement('div');
                messageContent.className = `max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
                    role === 'user' 
                        ? 'bg-blue-600 text-white' 
                        : role === 'error'
                        ? 'bg-red-600 text-white'
                        : service === 'ollama'
                        ? 'bg-gray-700 text-white'
                        : 'bg-gray-600 text-white'
                }`;
                
                messageContent.textContent = content;
                messageDiv.appendChild(messageContent);
                
                // Remove placeholder if it exists
                const placeholder = chatContainer.querySelector('.text-center');
                if (placeholder) {
                    placeholder.remove();
                }
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // Store in history
                this.chatHistory[service].push({ role, content, timestamp: new Date() });
            }
            
            addTypingIndicator(service) {
                const chatContainer = document.getElementById(`${service}-chat`);
                const typingId = `typing-${Date.now()}`;
                
                const typingDiv = document.createElement('div');
                typingDiv.id = typingId;
                typingDiv.className = 'flex justify-start';
                
                const typingContent = document.createElement('div');
                typingContent.className = `px-4 py-2 rounded-lg ${
                    service === 'ollama' ? 'bg-gray-700' : 'bg-gray-600'
                } text-white`;
                typingContent.innerHTML = '<div class="flex space-x-1"><div class="w-2 h-2 bg-white rounded-full animate-bounce"></div><div class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.1s"></div><div class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.2s"></div></div>';
                
                typingDiv.appendChild(typingContent);
                chatContainer.appendChild(typingDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                return typingId;
            }
            
            removeTypingIndicator(service, typingId) {
                const typingElement = document.getElementById(typingId);
                if (typingElement) {
                    typingElement.remove();
                }
            }
            
            estimateTokens(text) {
                // Rough estimation: 1 token ≈ 4 characters
                return Math.ceil(text.length / 4);
            }
            
            updateMetrics() {
                document.getElementById('ollama-latency').textContent = `${this.metrics.ollama.latency} ms`;
                document.getElementById('github-latency').textContent = `${this.metrics.github.latency} ms`;
                document.getElementById('ollama-tokens').textContent = this.metrics.ollama.tokens;
                document.getElementById('github-tokens').textContent = this.metrics.github.tokens;
            }
            
            clearChat() {
                this.chatHistory = { ollama: [], github: [] };
                this.metrics = { ollama: { latency: 0, tokens: 0 }, github: { latency: 0, tokens: 0 } };
                
                document.getElementById('ollama-chat').innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <div class="text-4xl mb-2">🤖</div>
                        <p>Select an Ollama model to start chatting</p>
                    </div>
                `;
                
                document.getElementById('github-chat').innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <div class="text-4xl mb-2">☁️</div>
                        <p>Ready to chat with GitHub Models</p>
                    </div>
                `;
                
                this.updateMetrics();
            }
            
            exportChat() {
                const exportData = {
                    timestamp: new Date().toISOString(),
                    ollama: {
                        model: this.selectedOllamaModel,
                        chat: this.chatHistory.ollama,
                        metrics: this.metrics.ollama
                    },
                    github: {
                        model: this.selectedGitHubModel,
                        chat: this.chatHistory.github,
                        metrics: this.metrics.github
                    }
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `chat-playground-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }
        
        // Initialize chat playground when the page loads
        let chatPlayground = null;
        
        // Initialize chat playground when switching to chat playground service
        function initializeChatPlayground() {
            if (!chatPlayground) {
                chatPlayground = new ChatPlayground();
            }
        }
        
        // Service-specific initialization functions
        function initializeChromaService() {
            const testButton = document.getElementById('test-chroma');
            const refreshButton = document.getElementById('refresh-chroma');
            const statusDiv = document.getElementById('chroma-status');
            const demoDiv = document.getElementById('chroma-demo');
            const collectionsList = document.getElementById('collections-list');
            const createCollectionBtn = document.getElementById('create-collection');
            const addDocumentBtn = document.getElementById('add-document');
            const searchSimilarBtn = document.getElementById('search-similar');
            const resultsDiv = document.getElementById('chroma-results');
            
            if (testButton) {
                testButton.addEventListener('click', async () => {
                    statusDiv.innerHTML = '<div class="text-center text-gray-500 py-8"><div class="text-4xl mb-2">🔄</div><p>Testing ChromaDB v2 API...</p></div>';
                    
                    try {
                        const response = await fetch('/api/chroma/health');
                        const result = await response.json();
                        
                        if (response.ok && (result.status === 'healthy' || result.status === 'connected')) {
                            statusDiv.innerHTML = '<div class="text-center text-green-500 py-8"><div class="text-4xl mb-2">✅</div><p>ChromaDB v2 API Connected!</p><p class="text-sm mt-2">Status: ' + result.status + '</p><p class="text-xs mt-1">Vector database ready for RAG operations</p></div>';
                            demoDiv.classList.remove('hidden');
                            loadCollections();
                        } else {
                            statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>ChromaDB connection failed</p><p class="text-sm mt-2">' + (result.message || 'Service unavailable') + '</p><p class="text-xs mt-1">Make sure ChromaDB is running: chroma run --host 0.0.0.0 --port 8081</p></div>';
                        }
                    } catch (error) {
                        statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>Connection test failed</p><p class="text-sm mt-2">' + error.message + '</p><p class="text-xs mt-1">Check if ChromaDB service is running on port 8081</p></div>';
                    }
                });
            }
            
            if (refreshButton) {
                refreshButton.addEventListener('click', () => {
                    loadCollections();
                });
            }
            
            if (createCollectionBtn) {
                createCollectionBtn.addEventListener('click', async () => {
                    const collectionName = prompt('Enter collection name:');
                    if (collectionName) {
                        try {
                            const response = await fetch('/api/chromadb/collections', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ name: collectionName })
                            });
                            
                            if (response.ok) {
                                loadCollections();
                                resultsDiv.innerHTML = '<div class="text-green-400">✅ Collection "' + collectionName + '" created successfully!</div>';
                            } else {
                                resultsDiv.innerHTML = '<div class="text-red-400">❌ Failed to create collection</div>';
                            }
                        } catch (error) {
                            resultsDiv.innerHTML = '<div class="text-red-400">❌ Error: ' + error.message + '</div>';
                        }
                    }
                });
            }
            
            if (addDocumentBtn) {
                addDocumentBtn.addEventListener('click', async () => {
                    const text = document.getElementById('document-text').value;
                    if (text.trim()) {
                        try {
                            const response = await fetch('/api/chromadb/documents', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ 
                                    text: text,
                                    collection: 'default'
                                })
                            });
                            
                            if (response.ok) {
                                resultsDiv.innerHTML = '<div class="text-green-400">✅ Document added to collection!</div>';
                                document.getElementById('document-text').value = '';
                            } else {
                                resultsDiv.innerHTML = '<div class="text-red-400">❌ Failed to add document</div>';
                            }
                        } catch (error) {
                            resultsDiv.innerHTML = '<div class="text-red-400">❌ Error: ' + error.message + '</div>';
                        }
                    }
                });
            }
            
            if (searchSimilarBtn) {
                searchSimilarBtn.addEventListener('click', async () => {
                    const query = document.getElementById('search-query').value;
                    if (query.trim()) {
                        try {
                            const response = await fetch('/api/chromadb/search', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ 
                                    query: query,
                                    collection: 'default',
                                    limit: 5
                                })
                            });
                            
                            if (response.ok) {
                                const results = await response.json();
                                displaySearchResults(results);
                            } else {
                                resultsDiv.innerHTML = '<div class="text-red-400">❌ Search failed</div>';
                            }
                        } catch (error) {
                            resultsDiv.innerHTML = '<div class="text-red-400">❌ Error: ' + error.message + '</div>';
                        }
                    }
                });
            }
            
            async function loadCollections() {
                try {
                    const response = await fetch('/api/chromadb/collections');
                    const data = await response.json();
                    
                    if (response.ok) {
                        collectionsList.innerHTML = '';
                        if (data.collections && data.collections.length > 0) {
                            data.collections.forEach(collection => {
                                const collectionDiv = document.createElement('div');
                                collectionDiv.className = 'bg-gray-700 p-2 rounded text-sm';
                                collectionDiv.innerHTML = `
                                    <div class="font-medium text-white">${collection.name}</div>
                                    <div class="text-gray-400 text-xs">ID: ${collection.id}</div>
                                `;
                                collectionsList.appendChild(collectionDiv);
                            });
                        } else {
                            collectionsList.innerHTML = '<div class="text-gray-400 text-sm">No collections found</div>';
                        }
                    }
                } catch (error) {
                    collectionsList.innerHTML = '<div class="text-red-400 text-sm">Error loading collections</div>';
                }
            }
            
            function displaySearchResults(results) {
                if (results.documents && results.documents.length > 0) {
                    let html = '<div class="space-y-2">';
                    results.documents.forEach((doc, index) => {
                        html += `
                            <div class="bg-gray-700 p-3 rounded">
                                <div class="text-sm text-gray-400">Result ${index + 1} (Score: ${results.distances ? results.distances[index].toFixed(3) : 'N/A'})</div>
                                <div class="text-white mt-1">${doc}</div>
                            </div>
                        `;
                    });
                    html += '</div>';
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<div class="text-gray-400">No similar documents found</div>';
                }
            }
        }
        
        function initializeLangGraphService() {
            const startButton = document.getElementById('start-langgraph');
            const openButton = document.getElementById('open-langgraph');
            const statusDiv = document.getElementById('langgraph-status');
            
            if (startButton) {
                startButton.addEventListener('click', async () => {
                    statusDiv.innerHTML = '<div class="text-center text-gray-500 py-8"><div class="text-4xl mb-2">🔄</div><p>Starting LangGraph Studio...</p></div>';
                    
                    try {
                        const response = await fetch('/api/langgraph/studios/start', { 
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });
                        const result = await response.json();
                        
                        if (response.ok) {
                            statusDiv.innerHTML = '<div class="text-center text-green-500 py-8"><div class="text-4xl mb-2">✅</div><p>LangGraph Studio started!</p><p class="text-sm mt-2">Agent visualization interface is ready</p><p class="text-xs mt-1">Access at: http://localhost:8083</p></div>';
                        } else {
                            statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>Failed to start LangGraph Studio</p><p class="text-sm mt-2">' + (result.detail || 'Unknown error') + '</p><p class="text-xs mt-1">Make sure LangGraph is installed: pip install langgraph</p></div>';
                        }
                    } catch (error) {
                        statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>Error starting LangGraph Studio</p><p class="text-sm mt-2">' + error.message + '</p><p class="text-xs mt-1">Check if the service is properly configured</p></div>';
                    }
                });
            }
            
            if (openButton) {
                openButton.addEventListener('click', () => {
                    window.open('http://localhost:8083', '_blank');
                });
            }
        }
        
        function initializeNeo4jService() {
            const generateButton = document.getElementById('generate-data');
            const dashboardButton = document.getElementById('open-dashboard');
            const statusDiv = document.getElementById('neo4j-status');
            
            if (generateButton) {
                generateButton.addEventListener('click', async () => {
                    statusDiv.innerHTML = '<div class="text-center text-gray-500 py-8"><div class="text-4xl mb-2">🔄</div><p>Generating realistic GraphRAG data...</p></div>';
                    
                    try {
                        const config = {
                            domain: 'enterprise',
                            num_users: 50,
                            num_organizations: 10,
                            num_projects: 25,
                            num_documents: 100,
                            num_interactions: 200,
                            num_relationships: 150,
                            include_temporal_data: true,
                            date_range_days: 365,
                            seed: Math.floor(Math.random() * 10000)
                        };
                        
                        const response = await fetch('/api/neo4j-faker/generate', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(config)
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok) {
                            const nodeCount = result.nodes ? result.nodes.length : result.nodes_created || 0;
                            const edgeCount = result.edges ? result.edges.length : result.edges_created || 0;
                            statusDiv.innerHTML = '<div class="text-center text-green-500 py-8"><div class="text-4xl mb-2">✅</div><p>GraphRAG data generated successfully!</p><p class="text-sm mt-2">' + nodeCount + ' nodes, ' + edgeCount + ' edges created</p><p class="text-xs mt-1">Data includes realistic enterprise relationships and interactions</p></div>';
                        } else {
                            statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>Failed to generate data</p><p class="text-sm mt-2">' + (result.detail || 'Unknown error') + '</p><p class="text-xs mt-1">Make sure Neo4j and Faker are installed: pip install neo4j py2neo faker</p></div>';
                        }
                    } catch (error) {
                        statusDiv.innerHTML = '<div class="text-center text-red-500 py-8"><div class="text-4xl mb-2">❌</div><p>Error generating data</p><p class="text-sm mt-2">' + error.message + '</p><p class="text-xs mt-1">Check if Neo4j Faker integration is available</p></div>';
                    }
                });
            }
            
            if (dashboardButton) {
                dashboardButton.addEventListener('click', () => {
                    window.open('/api/neo4j-faker/dashboard', '_blank');
                });
            }
        }
        
        // Override switchService to initialize services
        const originalSwitchService = switchService;
        switchService = function(serviceName) {
            originalSwitchService(serviceName);
            
            if (serviceName === 'chat-playground') {
                // Small delay to ensure DOM is ready
                setTimeout(initializeChatPlayground, 100);
            } else if (serviceName === 'chroma') {
                setTimeout(initializeChromaService, 100);
            } else if (serviceName === 'langgraph') {
                setTimeout(initializeLangGraphService, 100);
            } else if (serviceName === 'neo4j-faker') {
                setTimeout(initializeNeo4jService, 100);
            }
        };
    </script>
</body>
</html>
